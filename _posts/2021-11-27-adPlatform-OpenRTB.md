---
layout: post
title:  "oRTB 프로토콜"
subtitle:   "oRTB 프로토콜"
categories: adPlatform
tags: oRTB RTB OpenRTB
comments: false
---

### &#128204; RTB (Real Time Bidding)
RTB란 실시간으로 이루어지는 경매로, 광고주가 인벤토리를 구매하는 자동화 시스템입니다.

### &#128204; oRTB (Open RTB)
Open RTB는 광고 판매자와 구매자 간의 Real Time Bidding을 위한 인터페이스를 의미합니다.  
<br/>
디지털 광고 시장 내에서 광고를 사고 파는 데 다양한 플레이어(AdNetwork, AdExcange 등)들이 생겨났으며, 각 플레이어들은 하나 이상의 플레이어와 광고를 사고 팔면서 수 많은 광고 교환 작업들이 발생하게 되었습니다. 이때, 매번 거래를 위한 인터페이스 조정 작업의 병행하는 작업이 필요하게 되었습니다.  
<br/>
하지만 이는 다수의 거래 관계가 만들어지면서 매번 서로 다른 규격(인터페이스)을 지원해야 하는 불편함이 발생하였고, 결국 서로 광고를 교환하기 위한 표준 인터페이스의 필요성이 대두되었답니다. 이에 대하여 DataXu, Fiksu 그리고 [X+1]의 DSP 업체와 Nexage, Pubmatic, Smaata 그리고 Jumptap과 같은 SSP 업체들은 광고 거래 시 당사자 간의 의사 소통을 표준화하기 위하여 2011년 02월 Open RTB 1.0을 출시하였습니다.  
<br/>
이후 해당 방법은 업계의 좋은 반응과 함께 지속적인 발전이 있었고, 2012년 1월 IAB 협회에서 표준으로 채택하였습니다.  

> &#128226; 정리하자면 oRTB 프로토콜이란 여러 DSP와 여러 SSP가 자유롭게 통신할 수 있도록 정한 **표준**입니다!!  

![ad img](/assets/ad/2.JPG)  

SSP는 광고를 가지고 있지 않기 때문에 최대한 많은 정보를 넘겨야 효율적인 광고 운영이 가능합니다.  
그렇지만 SSP가 자신들만의 용어로 전달하면 DSP가 해석을 할 수 없기 때문에 IAB에서 정해준 항목대로 트래픽 정보를 넣어서 보내야합니다.  
&#10140; 광고 트래픽이 발생하면 광고 유닛에 설정된 미디에이션에 맞게 광고를 호출합니다. 그렇게 되면 Bid Request - Bid Response가 광고 공급 단위 만큼 발생하게 됩니다.  

> 각 DSP도 개제 위치 별로 관리하는 키가 있습니다. AP마다 이렇게 관리하는 키가 다르기 때문에 Bid Request가 같을 수는 없습니다. 하지만 트래픽 정보는 고정적으로 발생합니다!  
정리하자면, DSP에는 기본적인 트래픽 정보가 전달 되지만 AP마다 요구하는 정보가 조금씩 다르기 때문에 커스텀이 될 수 있습니다.  

#### oRTB를 기반으로 ADExchange를 진행하는 플로우
![ad img](/assets/ad/3.JPG)

1. 매체사에서 광고를 요청하는 AdRequest가 발생합니다.  
이 때 매체사는 웹 페이지 / IOS App / Android App 등이 될 수가 있습니다.  
<br/>
2. 이 때, Exchange 서버는 BidRequest를 Bidder에게 요청합니다.  
Bidder는 광고 RTB ( Real Time Bidding )에 참여하는 업체를 의미하며, AdNetwork 업체라고 볼 수 있습니다.  
BidRequest를 요청할 때는 매체사 정보, 디바이스 정보, 유저 정보, 비딩 정보 등을 함께 업체에 보내줍니다.  
<br/>
3. Bidder ( AdNetwork ) 업체는 BidResponse를 내려줘야합니다.  
Bidder 서버에서는 내부적으로 이 비딩에 참여할지 결정한 후, 매체사에서 보내준 **유저 정보에 적합한 광고**를 내려줘야합니다.  

> &#10140; 유저가 반응할 확률이 높은 광고를 내려줘야 기대수익이 높아지기 때문입니다.  

이 때, 비딩 정보와 광고 정보와, 마크업 데이터를 내려줘야합니다.  
비딩 정보에는 화폐 단위, 비딩에 참여하는 광고 가격 등이 들어가게 되며, 광고 정보에는 광고 시안 이미지 링크, Win notice Url 정보 등이 들어가게 됩니다.  
여기서 말하는 마크업 정보는 BidResonse > seatbid > bid > adm 값을 의미합니다. ~~( irb openrtb 규격서의 4.2.3 Object: Bid 참고 )~~  
여기에는 Win Notice URL 태그와 이미지 시안 태그와 Click URL A태그가 들어가있습니다.  
이 마크업 데이터가 매체사에 그대로 내려가서 보여집니다.  
아래와 같은 구조로 보내지게 됩니다.  
{% highlight HTML %}
<a href="광고 랜딩 URL (보통 클릭을 잡을 수 있는 URL이 될거다)"><img src="이미지시안.jpb""></a><img src="WinNoticeUrl (이 태그가 불려질 때 WinNoticeUrl이 불려지는 거다)"></img>
{% endhighlight %}
<br/>
4. 비딩 입찰에서 이기게 되면, WinNoticeUrl이 호출되게 됩니다.  
위에서 선언해둔 마크업이 매체사에 내려가게 되며, 매체사의 지면에 선언해둔 마크업이 삽입되게 됩니다.  
그리고 그 지면이 불려졌을 때 마크업에 있던 Win Notice Url이 불려지게 되면서, 
Bidder는 비딩 입찰에 성공했음을 알게됨과 동시에, Bidder의 광고가 노출(Impression)되었음을 알게됩니다.  

### &#128204; 성과형 광고 호출 방식
![ad img](/assets/ad/4.JPG)

1. 사용자(Audience)가 매체에 접속하면 광고 SDK를 통해 연결된 SSP에 광고를 요청합니다.  
2. SSP는 광고를 요청한 지면의 정보와 사용자의 정보(식별자 : ADID값)를 DSP 보내고 광고를 요청합니다.  
3. DSP는 현재 등록된 광고들 중에서 여러 필터링 조건에 맞는 광고를 우선 추리고, 다시 기대수익이 가장 높은 광고를 선택해서 SSP에 입찰합니다.  
4. SSP는 여러 DSP들로부터 받은 광고 중에서 eCPM이 가장 높은 광고를 선택해서 노출합니다.  
5. 만약 사용자가 노출된 광고를 클릭해서 랜딩페이지를 방문하거나 결제를 하는 등 액션을 취하면 광고 SDK를 통해서 사용자 행동 이력을 DMP로 제공합니다.  

> &#128226; eCPM (effective CPM) : 다양한 과금 타입의 광고를 모두 CPM으로 한산한 값으로 eCPM = either(CPM, BA * pCTR * 1000,BA * pCTR * pCVR * 1000)으로 구합니다.  
